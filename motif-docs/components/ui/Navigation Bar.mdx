import { Disclosure } from "@headlessui/react"
import cn from "classnames"
import { Search } from "@components/ui/search"
import { Menu, Close } from "@components/icons"
import { Button } from "@components/button"

export const NavigationBar = ({ items, searchData, className, large, path, buttonTitle, buttonHref, border, Icon }) => {
  return <Disclosure
      as="nav"
      className={cn(className, {
        "border-b border-gray-200": border === "dashed" || border === "solid",
        "border-dashed": border === "dashed",
        "border-dashed": border === "solid",
        "bg-white": large,
      })}>
    {({ open }) => (<>
      <div
        className={cn("mx-auto px-4 sm:px-6 md:px8", {
          "bg-transparent": open
        })}>
        <div className={cn("relative flex items-center justify-between", {
            "h-16": !large,
            "h-20 sm:h-24": large,
          })}>
          <div className="flex flex-1 items-center justify-start. gap-4">
            { Icon && <div className="flex items-center flex-shrink-0 pl-1 sm:pl-0">{Icon}</div> }
            { searchData &&
              <div className="hidden sm:block flex-grow max-w-[400px]">
                <Search data={searchData} />
              </div>
            }
            <div className={cn(
                "hidden items-center justify-end flex-grow sm:flex",
                { "sm:mr-4": !large }
              )}>
              <div className={cn("flex flex-row")}>
                {items.map((item) => {
                  const active = path?.startsWith(item.baseHref || item.href)
                  return (
                    <a
                      key={item.title}
                      href={item.href}
                      target={item.target}
                      className={cn(
                          "text-slate-900 no-underline",
                          {
                            "px-3": large,
                            "px-2 text-sm": !large,
                            "bg-gray-200 text-white": !!item.current,
                            "rounded-md font-medium py-2 ease-in-out duration-200 transition hover:bg-black/5": !item.current,
                            "text-fuchsia-500 hover:text-fuchsia-500": active,
                            "text-slate-900": !active,
                          }
                        )}
                      aria-current={item.current ? "page" : undefined}
                    >
                      {item?.Icon ?
                        <item.Icon className="h-5 w-5 sm:h-6 sm:w-6 text-slate-900"/> :
                        item.title
                      }
                    </a>
                  )
                })}
              </div>
            </div>
          </div>
          { buttonTitle &&
            <Button size="sm" Component="a" href={buttonHref} target="_blank">{buttonTitle}</Button>
          }
          <div
            className="ml-2 flex items-center sm:hidden">
            <Disclosure.Button className="rounded-md inline-flex items-center justify-center p-2 ease-in-out duration-200 text-gray-400 transition hover:bg-slate-900/5 outline-none focus:outline focus:outline-slate-500">
              <span className="sr-only">Open main menu</span>
              {open ? (
                <Close
                  className="block h-6 w-6 text-slate-900"
                  aria-hidden="true"
                />
              ) : (
                <Menu
                  className="block h-6 w-6 text-slate-900"
                  aria-hidden="true"
                />
              )}
            </Disclosure.Button>
          </div>
        </div>
      </div>
      <Disclosure.Panel
        className={cn("sm:hidden", {
          "bg-white border-b border-dashed": open && large
        })}
      >
        <div className="mb-2 px-4 pt-2 pb-4 space-y-1">
          {items.map((item) => (
            <a
              key={item.title}
              href={item.href}
              target={item.target}
              className={cn(
                "transition no-underline rounded-md block font-medium text-sm leading-5 p-2 duration-200 text-slate-900 hover:bg-black/5 focus:outline outline-slate-400",
                {
                  "bg-black/5 text-gray-700": item.current,
                  "hover:bg-black/5 hover:text-slate-900": !item.current
                }
              )}
              aria-current={item.current ? "page" : undefined}
            >
              {item.title}
            </a>
          ))}
        </div>
      </Disclosure.Panel>
    </>
  )}
  </Disclosure>
}
