import { Sidebar as MotifSidebar } from "@components/ui/Sidebar.mdx"

export const theme = {
  item: 'text-sm py-1.5 px-1 transition',
  topItem: 'ml-2 mt-4 mb-2 font-semibold text-sm text-blueGray-900 hover:text-blueGray-900',
  itemActive: 'font-medium text-fuchsia-600 hover:text-fuchsia-600',
  topItemInactive: 'ml-2 mt-4 mb-2 font-semibold text-sm text-blueGray-900',
  itemInactive: 'text-gray-500 hover:text-blueGray-900',
  lineActive: 'border-l border-fuchsia-500'
}

export const getEntries = (files, baseFolderName, sections) => {
  const baseFolder = files?.folders?.find(f => f.name === baseFolderName)
  return sections.map(title => {
    const sectionFolder = baseFolder?.folders?.find(f => f.name === title)
    const items = sectionFolder?.files
      .sort((f, g) => (f.meta?.index || 0) - (g.meta?.index || 0))
      .map(file => {
        return {
          id: file.path,
          title: file.meta?.sidebarTitle || file.meta?.title || file.name.replace(/\.md$/, '').replace(/\.mdoc$/, ''),
          href: file.path
        }
      })
    return {
      id: title,
      title,
      items
    }
  })
}

export const Sidebar = ({ files, path, baseFolder, sections, topLinks }) => {
  const sectionEntries = getEntries(files, baseFolder, sections)
  return <div className="flex flex-col gap-1">
    { topLinks }
    <div className="h-2" />
    <MotifSidebar
        entries={[
          { id: "overview", title: "Overview", href: `/${baseFolder}` },
          ...sectionEntries
          ]}
        expandAll
        theme={theme}
        activeId={path}
      />
    </div>
}

{/* Example use */}
<Sidebar
  baseFolder="Reference"
  sections={["Getting Started", "Reference"]}
  />
